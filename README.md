/api/document/upload (controllers/Api) - ждет в post переменную file с содержимым файла csv. Записывает в базу.

/test (controllers/Test) - пример запроса curl метода /api/document/upload

/api/trigger (controllers/Api) - запускает процесс рассылки.

Рассылка происходит в очереди. Сперва туда складываются все элементы.

Затем каждый элемент обрабатывается отдельно.

При ошибке, отдельный элемент возвращается в очередь.

Предполагается что обработчик очереди будет висеть как php демон.